#!/bin/bash

s="$1" # source
b="$2" # bin
m="$b/Makefile"

ERR_BIN_MAKE=4

msg() { printf '%s\n' "$*" >&2; }

write() {
    echo "\
S = $s
B = $b"'
include $B/config.mk
include $S/make/common.mk
include $S/make/Makefile
include $S/make/Makefile.dep'
}

mkdir -p     "$b"

write > "$m"
if test $? -ne 0; then exit $ERR_BIN_MAKE; fi

msg "$m created"
