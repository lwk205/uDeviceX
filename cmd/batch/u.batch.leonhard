. u.utils

n=$1; shift
x=$1; shift
y=$1; shift
z=$1; shift
e=$1; shift # executable

if   test $#   -eq 0
then Time="--time 00:10:00"
elif test "$1"   = -
then                   shift
else Time="--time $1"; shift
fi

Args="-oo=out.txt -eo=err.txt "rusage[ngpus_excl_p=$ngpus]" $Time $@"
exec1 bsub -N $n $Args /dev/stdin <<EOF
#!/bin/bash

. u.load.leonhard
srun `u.wrap "$e"` $x $y $z
EOF
