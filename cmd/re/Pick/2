. u.re.conf

: ${AWK=awk}

i="$1"; shift
id="$1"; shift

t=/tmp/pick.$$
trap 0 1 2 3 15

u.re.pick1 "$i" "$id" > "$t"

scn () {
   "$AWK" -v RS= \
   '
   { print $2 }
   ' "$@"
}

dirname0 () {
   while read f
   do  dirname -- "$f"
   done
}
uni () { "$AWK" '!($0 in s){print; s[$0]}'; }

# create cp commands
cp0() {
   "$AWK" -v q=\' -v RS= \
   '
   function qq(s) { return q s q }
   { print "cp --", qq($1), qq($2) }
   ' "$@"
}

# scn "$t" | dirname0 | uni

cp0 "$t"
echo "$b/$i"
