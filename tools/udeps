#!/bin/bash

U=u/x # default unit

build0 () {
    u.u0 "$U" | D=_ G=. c.main "$U"/make "$U"/make/_
}

build1 () {
    if test ! -d "$U"
    then printf "udeps: $U is not a directory\n" >&2
	 exit 1
    fi
    build0
}

build () {
    if test $# -ne 0; then U=$1; shift; fi
    build1
}

list () {
    u.u0 "$U" | D=_ G=. c.act            "$U"/make/_
}

collapse () {
    u.u0 "$U" | D=_ G=. c.collapse        "$U"/make/_
}

if   test $# -eq 1 -a "$1" = -l
then list
elif test $# -eq 1 -a "$1" = -c
then collapse
else build "$@"
fi




