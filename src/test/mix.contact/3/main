#### contact force: several cell and rigid objects
# sTEST: mix.contact.t3
cd test/mix.contact/3
X=32 Y=16 Z=16 R=7.5
rad=3.0 fr=0.2 sc=0.5 ang=0.0
SEED=123 plcmt.ro $X $Y $Z  $rad  $fr $sc $ang        rigs-ic.txt  rbcs-ic.txt
u.cp.rig cylinder      rig.ply
u.cp.rbc sph/sc/642    rbc.off
u.cp.rbc rbc/sc/642    ref.off
tsdf /dev/stdin sdf.dat sdf.vti <<EOF
    extent     $X $Y $Z
    N          $X $Y $Z
    obj_margin 3.0
    !cylinder axis 1 0 0 point xc yc zc radius $R
EOF
:
u.run udx conf.cfg "
wall   = { active = true }
time   = { type = \"const\"; wall = 1.0; dt = 5e-4; end = 1000.0 }
glb    = { L = [$X, $Y, $Z] }
bforce = { type = \"constant\" ;  f = [1.0, 0.0, 0.0] }
rbc    = {
    stress_free      = true
    stress_free_file = \"ref.off\"
    totArea          = `off.area   ref.off`
    totVolume        = `off.volume ref.off`
}"
:
ply2punto r/00002.ply | uscale 0.1 > ply.out.txt
