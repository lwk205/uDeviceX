#### velocity controller for flow around cylinder
# nTEST: vcon.t0
set -eu
rm -rf bop h5 diag.txt rbc.off
:
cp data/sdf/cyl1/cyl.dat sdf.dat
(cd ../cmd; make ) > /dev/null
:
u.conf conf/double.poiseuille.h <<!!!
   numberdensity=1
   tend=2.01 part_freq=4000 walls wall_creation=1
   VCON_SAMPLE_FREQ=1 VCON_LOG_FREQ=500
   VCON_ADJUST_FREQ=500
   FORCE_CONSTANT FORCE_PAR_A=0
   field_dumps part_dumps
   field_freq=4000
   run
!!!
(make clean && u.make -j) > /dev/null
u.run ./udx test/vcont/vcon.cfg
u.avgh5 0 u 2 h5/flowfields-0001.h5 | uscale 0.1 > h5.out.txt


#### velocity controller for flow around cylinder (2 nodes)
# nTEST: vcon.t1
set -eu
rm -rf bop h5 diag.txt rbc.off
:
cp data/sdf/cyl1/cyl.dat sdf.dat
(cd ../cmd; make ) > /dev/null
:
u.conf conf/double.poiseuille.h <<!!!
   numberdensity=1
   tend=2.01 part_freq=4000 walls wall_creation=1
   VCON_SAMPLE_FREQ=1 VCON_LOG_FREQ=500
   VCON_ADJUST_FREQ=500
   FORCE_CONSTANT FORCE_PAR_A=0
   field_dumps part_dumps
   field_freq=4000
   run
!!!
(make clean && u.make -j) > /dev/null
u.run 1 1 2 ./udx test/vcont/vcon.cfg
u.avgh5 0 u 2 h5/flowfields-0001.h5 | uscale 0.1 > h5.out.txt
