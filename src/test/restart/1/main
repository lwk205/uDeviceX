#### solvent with wall restart
# nTEST: rstrt.t2
rm -rf bop h5 diag.txt bin.1 bin.2 sdf.dat
:
u.cp.sdf wall1/wall.dat sdf.dat
:
u.conf conf/couette.h <<!!!
   tend=0.5   
   walls wall_creation=100
   BASE_STRT_DUMP=\"bin.1/strt\"
   strt_dumps=true
   strt_freq=10000
   RESTART=false
   run
   tend=2.01
   RESTART=true
   BASE_STRT_READ=\"bin.1/strt\"
   BASE_STRT_DUMP=\"bin.2/strt\"
   run
!!!
:
u.strtdir bin.1
u.strtdir bin.2
(make clean && u.make -j) > /dev/null
:
u.run ./bin.1/udx '
time = {
    type = "const"
    dt = 5e-4
}
glb = {
    L = [16, 16, 16]
}
wvel = {
    type = "shear";
    gdot = 5.0;
    vdir = 0;
    gdir = 2;
};
dump = {
    field = true;
    parts = true;
    freq_field = 4000;
    freq_parts = 4000;
};'
:
u.run ./bin.2/udx '
time = {
    type = "const"
    dt = 5e-4
}
glb = {
    L = [16, 16, 16]
}
wvel = {
    type = "shear";
    gdot = 5.0;
    vdir = 0;
    gdir = 2;
};
bforce ={
    type = "constant";
    f = [3.333e-2, 0., 0.];
};
dump = {
    field = true;
    parts = true;
    freq_field = 4000;
    freq_parts = 4000;
};'
u.avgh5 0 u 1 h5/flowfields-0000.h5 | uscale 0.1 > h5.out.txt
