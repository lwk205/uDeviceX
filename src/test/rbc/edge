#### RBC in a periodic box
# nTEST: diag.t2
rm -rf bop diag.txt h5 ply rbc.off
cp data/cells/rbc/498.off rbc.off
x=0.75 y=8 z=12; echo 1 0 0 $x  0 1 0 $y  0 0 1 $z  0 0 0 1 > rbcs-ic.txt
:
u.conf conf/couette.h <<!!!
   rbcs tend=0.5 part_freq=300
   run
!!!
{ make clean && u.make -j ; } > /dev/null
sh runfile
ply2punto r/00003.ply | uscale 100 > ply.out.txt

#### RBC initialy rotated
# nTEST: rotated.t1
rm -rf bop diag.txt h5 ply rbc.off
cp data/cells/rbc/498.off rbc.off
x=0.75 y=8 z=12   c=0.5 s=0.866
echo     1  0   0 $x              \
         0 $c -$s $y              \
         0 $s  $c $z              \
         0  0   0  1 > rbcs-ic.txt
:
u.conf conf/couette.h <<!!!
   rbcs tend=0.5 part_freq=300
   run
!!!
{ make clean && u.make -j ; } > /dev/null
sh runfile
ply2punto r/00003.ply | uscale 100 > ply.out.txt

#### RBC with wall
# nTEST: diag.t3
rm -rf bop diag.txt h5 ply rbc.off
cp data/cells/rbc/498.off rbc.off
cp data/sdf/wall1/wall.dat sdf.dat
x=0.75 y=8 z=12; echo 1 0 0 $x  0 1 0 $y  0 0 1 $z  0 0 0 1 > rbcs-ic.txt
:
u.conf conf/couette.h <<!!!
   rbcs tend=0.5 part_freq=300  walls  wall_creation=100
   field_dumps part_dumps field_freq=300 WVEL_PAR_Z
   run
!!!
{ make clean && u.make -j ; } > /dev/null
sh runfile
ply2punto r/00003.ply | uscale 100 > ply.out.txt

#### one RBC around cylinder
# nTEST: flow.around.t1
rm -rf bop diag.txt h5 ply rbc.off
cp data/cells/rbc/498.off rbc.off
cp data/sdf/cyl1/cyl.dat sdf.dat
x=0.75 y=8 z=9; echo 1 0 0 $x  0 1 0 $y  0 0 1 $z  0 0 0 1 > rbcs-ic.txt
:
Force="bforce={type=\"constant\"; f=[1.6666667,0.,0.];};"
u.conf conf/around.h <<!!!
   kBT=1e-7 rbcs tend=3.0 part_freq=5000 walls wall_creation=1000
   field_dumps part_dumps field_freq=5000 pushrbc
   run
!!!
{ make clean && u.make -j ; } > /dev/null
u.run ./udx $Force
ply2punto r/00001.ply | uscale 100 > ply.out.txt

#### two RBCs around cylinder
# nTEST: flow.around.t2
rm -rf bop diag.txt h5 ply rbc.off
cp data/cells/rbc/498.off rbc.off
x=0.75  y=3 z=9; echo 1 0 0 $x  0 1 0 $y  0 0 1 $z  0 0 0 1 >  rbcs-ic.txt
x=0.75 y=13 z=9; echo 1 0 0 $x  0 1 0 $y  0 0 1 $z  0 0 0 1 >> rbcs-ic.txt
cp data/sdf/cyl1/cyl.dat sdf.dat
:
Force="bforce={type=\"constant\"; f=[1.6666667,0.,0.];};"
u.conf conf/around.h <<!!!
   rbcs tend=3.0 part_freq=5000 walls wall_creation=1000 kBT=1e-7
   field_dumps part_dumps field_freq=5000 pushrbc
   run
!!!
{ make clean && u.make -j ; } > /dev/null
u.run ./udx $Force
ply2punto r/00001.ply | uscale 10 > ply.out.txt
