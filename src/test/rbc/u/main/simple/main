#### periodic box: stretch
# snTEST: rbc.u.main.simple.0
set -eu
rm -rf bop diag.txt h5 ply rbc.off
:
S=`u.cp.s`
U=u/rbc/main
C=conf/lina.h
A=5e2 : stretching force L/S^2
nv=2562
seed=123456
cell=data/cells/rbc/$nv.off
cp              $cell           rbc.off
u.stretch $A 5% $cell         > rbc.stretch
cp $S/data/ic/ident             rbcs-ic.dat
volume=`off.volume $cell` : needs gitlab:off
area=`off.area $cell`
:
x=24 y=16 z=16; echo 1 0 0 $x  0 1 0 $y  0 0 1 $z  0 0 0 1 > rbcs-ic.txt
:
u.conf $S $U $C <<!
   rbcs
   RBC_STRETCH MESH_SHIFT_CENTER RBCtotArea=$area RBCtotVolume=$volume
   RBCnv=$nv RBC_RND=false
   run
!
{ make clean && u.make -j; } > /dev/null
:
u.run ./udx '
glb = {L = [48, 32, 32]}
rbc = {
    @include "rbc.lina.cfg"
    kBT = 0.00444302;
    ks = 3.26692647;
}
restrain = {
    kind = "rbc";
    freq = 1000;
};
dump = {
    parts = true;
};'
ply2punto r/00008.ply | uscale 1 > ply.out.txt
