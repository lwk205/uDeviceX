= meshbb
:lext: .adoc
:src: ../../../src
:stem: latexmath

Bounce back particles on a moving mesh

Let define the following quantities:

* stem:[\mathbf{r}_0, \mathbf{v}_0] : particle at time stem:[0]
* stem:[\mathbf{r}_1, \mathbf{v}_1] : particle at time stem:[dt] if
  there is no collision
* stem:[\mathbf{r}_n, \mathbf{v}_n] : particle at time stem:[dt] after
  bounce back
* stem:[h \in [0, dt]] : collision time
* stem:[\mathbf{r}_w, \mathbf{v}_w] : collision position and velocity
  of the surface

A particle colliding with a surface is bounced back as:

[stem]
++++
\mathbf{v}_n = 2 \mathbf{v}_w - \mathbf{v}_0, \\
\mathbf{r}_n = \mathbf{r}_w + (dt - h) \mathbf{v}_n.
++++



== interface

Allocate and deallocate `MeshBB` structure:

[source,cpp]
----
include::{src}/meshbb/imp.h[tag=mem]
----
